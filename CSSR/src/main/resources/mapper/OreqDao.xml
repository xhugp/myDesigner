<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xhu.dao.OreqDao">
    <select id="list" resultType="com.xhu.entity.Oreq">
        SELECT *
        FROM oreq
        WHERE 1 = 1
        <if test="oreq.companyId != null">
            AND  company_id = #{oreq.companyId}
        </if>
        <if test="oreq.userId != null">
            AND  user_id = #{oreq.userId}
        </if>
        <if test="oreq.oreqResult != null">
            AND  oreq_result = #{oreq.oreqResult}
        </if>
        <if test="oreq.oreqType != null">
            AND  oreq_type = #{oreq.oreqType}
        </if>
        AND oreq_create_time BETWEEN #{oreq.fromTime} AND  #{oreq.toTime}
        ORDER BY oreq_create_time
        <if test=" index != null and size != null">
            limit #{index},#{size}
        </if>
    </select>

    <select id="getOreq" resultType="com.xhu.entity.Oreq">
        SELECT *
        FROM oreq
        WHERE oreq_id = #{oreqId}
    </select>


    <select id="getCount" parameterType="com.xhu.entity.Oreq" resultType="java.lang.Integer">
        SELECT count(1)
        FROM oreq
        WHERE 1 = 1
        <if test="companyId != null">
            AND  company_id = #{companyId}
        </if>
        <if test="userId != null">
            AND  user_id = #{userId}
        </if>
        <if test="oreqResult != null">
            AND  oreq_result = #{oreqResult}
        </if>
        <if test="oreqType != null">
            AND  oreq_result = #{oreqType}
        </if>
        AND oreq_create_time BETWEEN #{fromTime} AND  #{toTime}
    </select>

    <insert id="add" parameterType="com.xhu.entity.Oreq">
        INSERT INTO oreq(user_id,company_id,order_id,oreq_content,oreq_type,oreq_create_time)
        VALUES (#{userId},#{companyId},#{orderId},#{oreqContent},#{oreqType},#{oreqCreateTime})
    </insert>

    <update id="update" parameterType="com.xhu.entity.Oreq">
        UPDATE oreq
        <trim prefix="set" suffixOverrides=",">
            <if test=" oreqResult != null ">
                oreq_result = #{oreqResult},
            </if>
            <if test=" oreqHandleTime != null ">
                oreq_handle_time = #{oreqHandleTime},
            </if>
        </trim>
        WHERE oreq_id = #{oreqId}
    </update>

    <delete id="delete">
        DELETE FROM oreq
        WHERE oreq_id = #{oreqId}
    </delete>

    <select id="check" resultType="java.lang.Integer">
        SELECT count(1)
        FROM oreq
        WHERE user_id = #{userId} AND order_id = #{orderId} AND oreq_result = "0"
    </select>

</mapper>