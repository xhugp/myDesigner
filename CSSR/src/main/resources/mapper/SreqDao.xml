<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xhu.dao.SreqDao">
    <select id="list" resultType="com.xhu.entity.Sreq">
        SELECT *
        FROM sreq
        WHERE 1 = 1
        <if test="sreq.companyId != null">
            AND  company_id = #{sreq.companyId}
        </if>
        <if test="sreq.userId != null">
            AND  user_id = #{sreq.userId}
        </if>
        <if test="sreq.srState != null">
            AND  sr_state = #{sreq.srState}
        </if>
        AND create_time BETWEEN #{sreq.fromTime} AND  #{sreq.toTime}
        ORDER BY create_time
        <if test=" index != null and size != null">
            limit #{index},#{size}
        </if>
    </select>

    <select id="getSreq" resultType="com.xhu.entity.Sreq">
        SELECT *
        FROM sreq
        WHERE sr_id = #{srId}
    </select>

    <select id="check" resultType="java.lang.Integer" parameterType="com.xhu.entity.Sreq">
        SELECT count(1)
        FROM sreq
        WHERE user_id = #{userId} AND company_id = #{companyId} AND sr_state = #{srState}
    </select>

    <select id="getCount" parameterType="com.xhu.entity.Sreq" resultType="java.lang.Integer">
        SELECT count(1)
        FROM sreq
        WHERE 1 = 1
        <if test="companyId != null">
            AND  company_id = #{companyId}
        </if>
        <if test="userId != null">
            AND  user_id = #{userId}
        </if>
        <if test="srState != null">
            AND  sr_state = #{srState}
        </if>
        AND create_time BETWEEN #{fromTime} AND  #{toTime}
    </select>

    <insert id="add" parameterType="com.xhu.entity.Sreq">
        INSERT INTO sreq(user_id,company_id,sr_time,sr_state,create_time,handle_time)
        VALUES (#{userId},#{companyId},#{srTime},#{srState},#{createTime},#{handleTime})
    </insert>

    <update id="update" parameterType="com.xhu.entity.Sreq">
        UPDATE sreq
        <trim prefix="set" suffixOverrides=",">
            <if test=" srState != null ">
                sr_state = #{srState},
            </if>
            <if test=" handleTime != null ">
                handle_time = #{handleTime},
            </if>
        </trim>
        WHERE sr_id = #{srId}
    </update>

    <delete id="delete">
        DELETE FROM sreq
        WHERE sr_id = #{srId}
    </delete>

</mapper>