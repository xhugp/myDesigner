<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xhu.dao.ManageDao">
    <!-- 查询所有记录 -->
    <select id="list" resultType="com.xhu.entity.Manage">
        SELECT *
        FROM manage
        ORDER BY manage_id
        <if test=" index != null and size != null">
            limit #{index},#{size}
        </if>
    </select>

    <!-- 查询记录总数 -->
    <select id="getCount" resultType="int">
        SELECT count(1)
        FROM manage
        <if test="companyId != null">
            WHERE company_id = companyId
        </if>
    </select>

    <!-- 根据管理者id查询 -->
    <select id="queryById" resultType="com.xhu.entity.Manage">
        SELECT *
        FROM manage
        WHERE manage_id = #{manageId}
    </select>

    <!-- 根据管理者登录名查询 -->
    <select id="queryByName" resultType="com.xhu.entity.Manage">
        SELECT *
        FROM manage
        WHERE manage_name = #{manageName}
    </select>

    <!-- 根据管理者公司ID -->
    <select id="queryByCompany" resultType="com.xhu.entity.Manage">
        SELECT *
        FROM manage
        WHERE company_id = #{companyId}
        ORDER BY manage_id
        <if test=" pageBean.index != null and pageBean.size != null">
            limit #{pageBean.index},#{pageBean.size}
        </if>
    </select>

    <!--添加记录 -->
    <insert id="add" useGeneratedKeys="true"
            keyProperty="manageId" keyColumn="manage_id" parameterType="com.xhu.entity.Manage">
        insert into manage (manage_name,manage_mc,manage_pwd,manage_phone,manage_email,manage_role,create_time,last_login_time,company_id)
        values
        (#{manageName},#{manageMc},#{managePwd},#{managePhone},#{manageEmail},#{manageRole},#{createTime},#{lastLoginTime},#{companyId})
    </insert>

    <!--修改记录 -->
    <update id="update" parameterType="com.xhu.entity.Manage">
        update manage
        <trim prefix="set" suffixOverrides=",">
            <if test=" manageMc != null ">
                manage_mc = #{manageMc},
            </if>
            <if test=" managePwd != null ">
                manage_pwd = #{managePwd},
            </if>
            <if test=" managePhone != null ">
                manage_phone = #{managePhone},
            </if>
            <if test=" manageEmail != null ">
                manage_email = #{manageEmail},
            </if>
            <if test=" lastLoginTime != null ">
                last_login_time = #{lastLoginTime},
            </if>
        </trim>
        where manage_id = #{manageId}
    </update>

    <delete id="deleteById">
        DELETE FROM
        manage
        WHERE
        manage_id = #{manageId}
    </delete>

    <!-- 批量删除 使用list-->
    <delete id="deleteBatch">
        delete from manage where manage_id in
        <foreach collection="deleteList" index="index" item="item"
                 open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

</mapper>